document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("inputJsonToCsv"),t=document.getElementById("outputJsonToCsv"),e=document.getElementById("btnJsonToCsv");n&&t&&e&&e.addEventListener("click",function(){t.value=function(n){if(!n)return"";let t;try{t=JSON.parse(n)}catch(n){return"Error parsing JSON: "+n.message}if(!Array.isArray(t))return"JSON root must be an array of objects.";if(!t.length)return"";const e={};t.forEach(function(n){n&&"object"==typeof n&&!Array.isArray(n)&&Object.keys(n).forEach(function(n){e[n]=!0})});const o=Object.keys(e);if(!o.length)return"No object keys found to create CSV columns.";function r(n){return null==n&&(n=""),'"'+(n="object"==typeof n?JSON.stringify(n):String(n)).replace(/"/g,'""')+'"'}const c=[];return c.push(o.map(r).join(",")),t.forEach(function(n){const t=o.map(function(t){return r(n&&n.hasOwnProperty(t)?n[t]:"")});c.push(t.join(","))}),c.join("\n")}(n.value||"")})});